# Algorithm Flow Diagrams

## ğŸ¯ Alert-to-Service Mapping Algorithm

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         INTELLIGENT 2-TIER MAPPING ALGORITHM                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: Alert with service_name, namespace, cluster, node
Output: graph_service, mapping_method, mapping_confidence

                        START
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Extract service_name        â”‚
            â”‚ from alert                  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ service_name exists         â”‚
            â”‚ and not empty?              â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚YES           â”‚NO
                   â–¼              â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
     â”‚ Direct Match Attempt â”‚     â”‚
     â”‚                      â”‚     â”‚
     â”‚ service_name IN      â”‚     â”‚
     â”‚ service_to_graph?    â”‚     â”‚
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
            â”‚YES   â”‚NO            â”‚
            â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚                     â”‚
            â–¼                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ TIER 1: DIRECT   â”‚   â”‚ TIER 2: FALLBACK       â”‚
  â”‚                  â”‚   â”‚                         â”‚
  â”‚ graph_service =  â”‚   â”‚ Extract from alert:     â”‚
  â”‚   service_name   â”‚   â”‚ â€¢ namespace             â”‚
  â”‚                  â”‚   â”‚ â€¢ cluster               â”‚
  â”‚ mapping_method = â”‚   â”‚ â€¢ node                  â”‚
  â”‚   'service_name' â”‚   â”‚                         â”‚
  â”‚                  â”‚   â”‚ For each service in     â”‚
  â”‚ confidence = 1.0 â”‚   â”‚ service_to_graph:       â”‚
  â”‚                  â”‚   â”‚                         â”‚
  â”‚ âœ“ DONE           â”‚   â”‚   score = 0             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                         â”‚
                         â”‚   IF ns match: +2       â”‚
                         â”‚   IF cluster match: +2  â”‚
                         â”‚   IF node match: +1     â”‚
                         â”‚                         â”‚
                         â”‚   IF score >= 2:        â”‚
                         â”‚      candidates.add()   â”‚
                         â”‚                         â”‚
                         â”‚ Any candidates?         â”‚
                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚YES       â”‚NO
                              â–¼          â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Select Best  â”‚  â”‚ UNMAPPED   â”‚
                    â”‚              â”‚  â”‚            â”‚
                    â”‚ best = max   â”‚  â”‚ graph_svc  â”‚
                    â”‚  (by score)  â”‚  â”‚   = None   â”‚
                    â”‚              â”‚  â”‚            â”‚
                    â”‚ graph_svc =  â”‚  â”‚ method =   â”‚
                    â”‚  best.name   â”‚  â”‚  'unmapped'â”‚
                    â”‚              â”‚  â”‚            â”‚
                    â”‚ method =     â”‚  â”‚ confidence â”‚
                    â”‚  'fallback'  â”‚  â”‚   = 0.0    â”‚
                    â”‚              â”‚  â”‚            â”‚
                    â”‚ confidence = â”‚  â”‚ âœ“ DONE     â”‚
                    â”‚  score / 5   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚              â”‚
                    â”‚ âœ“ DONE       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Mapping Success Rate:
  Direct: ~85%
  Fallback: ~12%
  Unmapped: ~3%
```

---

## ğŸ”„ Deduplication Scoring Algorithm

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            MULTI-CRITERIA DUPLICATE DETECTION                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: alert1, alert2 (within same cluster)
Output: True (duplicate) or False (unique)

                        START
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Check Temporal Proximity    â”‚
            â”‚                             â”‚
            â”‚ |time1 - time2|             â”‚
            â”‚ > 5 minutes?                â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚YES           â”‚NO
                   â–¼              â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
       â”‚ NOT DUPLICATE  â”‚        â”‚
       â”‚ return False   â”‚        â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                                 â”‚
                                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Initialize score = 0        â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ SCORING CRITERIA (Accumulate Points) â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
        â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Criterion 1:  â”‚ â”‚ Criterion 2:  â”‚ â”‚ Criterion 3: â”‚
â”‚ Same Alert    â”‚ â”‚ Same Service  â”‚ â”‚ Same Severityâ”‚
â”‚ Name?         â”‚ â”‚               â”‚ â”‚              â”‚
â”‚               â”‚ â”‚ graph_service â”‚ â”‚ severity     â”‚
â”‚ alert_name ==?â”‚ â”‚ ==?           â”‚ â”‚ ==?          â”‚
â”‚               â”‚ â”‚               â”‚ â”‚              â”‚
â”‚ YES: +3 pts   â”‚ â”‚ YES: +3 pts   â”‚ â”‚ YES: +1 pt   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
        â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Criterion 4:  â”‚ â”‚ Criterion 5:  â”‚ â”‚ Criterion 6: â”‚
â”‚ Same Category â”‚ â”‚ Similar       â”‚ â”‚ Same Initial â”‚
â”‚ + Subcategory â”‚ â”‚ Description   â”‚ â”‚ Group        â”‚
â”‚               â”‚ â”‚               â”‚ â”‚              â”‚
â”‚ Both match?   â”‚ â”‚ Jaccard > 0.7?â”‚ â”‚ init_group   â”‚
â”‚ (lowercase)   â”‚ â”‚               â”‚ â”‚ ==?          â”‚
â”‚               â”‚ â”‚               â”‚ â”‚              â”‚
â”‚ YES: +2 pts   â”‚ â”‚ YES: +2 pts   â”‚ â”‚ YES: +1 pt   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                   â”‚
        â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Criterion 7:  â”‚                  â”‚ Criterion 8: â”‚
â”‚ Same Pod      â”‚                  â”‚ Same NS +    â”‚
â”‚               â”‚                  â”‚ Cluster      â”‚
â”‚ pod ==?       â”‚                  â”‚              â”‚
â”‚               â”‚                  â”‚ Both match?  â”‚
â”‚               â”‚                  â”‚              â”‚
â”‚ YES: +4 pts   â”‚                  â”‚ YES: +1 pt   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Total Score >= 5?           â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚YES           â”‚NO
                   â–¼              â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ IS DUPLICATE   â”‚  â”‚ UNIQUE      â”‚
       â”‚ return True    â”‚  â”‚ return Falseâ”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example Combinations:
  â€¢ Same pod + anything: 4 + x >= 5 âœ“
  â€¢ Same alert + service: 3 + 3 = 6 âœ“
  â€¢ Same cat+subcat + severity + group: 2+1+1+1 = 5 âœ“
  â€¢ Similar desc + alert: 2 + 3 = 5 âœ“
```

---

## ğŸ§¬ Feature Engineering Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FEATURE EXTRACTION DECISION TREE                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

For each alert:
                        START
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Alert mapped to graph?      â”‚
            â”‚ (graph_service exists?)     â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚YES           â”‚NO
                   â–¼              â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
   â”‚ EXTRACT GRAPH         â”‚     â”‚
   â”‚ FEATURES (20)         â”‚     â”‚
   â”‚                       â”‚     â”‚
   â”‚ 1. Get service node   â”‚     â”‚
   â”‚    from graph         â”‚     â”‚
   â”‚                       â”‚     â”‚
   â”‚ 2. Degree metrics     â”‚     â”‚
   â”‚    â€¢ degree()         â”‚     â”‚
   â”‚    â€¢ in_degree()      â”‚     â”‚
   â”‚    â€¢ out_degree()     â”‚     â”‚
   â”‚                       â”‚     â”‚
   â”‚ 3. Centrality         â”‚     â”‚
   â”‚    â€¢ pagerank_cache[] â”‚     â”‚
   â”‚    â€¢ betweenness[]    â”‚     â”‚
   â”‚    â€¢ clustering_coef()â”‚     â”‚
   â”‚                       â”‚     â”‚
   â”‚ 4. Relationships      â”‚     â”‚
   â”‚    For predecessors:  â”‚     â”‚
   â”‚      Count CALLS/     â”‚     â”‚
   â”‚      OWNS/BELONGS_TO  â”‚     â”‚
   â”‚    For successors:    â”‚     â”‚
   â”‚      Count CALLS/     â”‚     â”‚
   â”‚      OWNS/BELONGS_TO  â”‚     â”‚
   â”‚                       â”‚     â”‚
   â”‚ 5. Ratios & Direction â”‚     â”‚
   â”‚    â€¢ ratio_calls      â”‚     â”‚
   â”‚    â€¢ ratio_owns       â”‚     â”‚
   â”‚    â€¢ ratio_belongs    â”‚     â”‚
   â”‚    â€¢ dep_direction    â”‚     â”‚
   â”‚                       â”‚     â”‚
   â”‚ 6. Neighbors          â”‚     â”‚
   â”‚    â€¢ avg_neighbor_deg â”‚     â”‚
   â”‚    â€¢ max_neighbor_deg â”‚     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
               â”‚                 â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ EXTRACT ALERT METADATA            â”‚
        â”‚ FEATURES (19)                     â”‚
        â”‚                                   â”‚
        â”‚ 1. Basic Encodings                â”‚
        â”‚    â€¢ severity_encoded (0-4)       â”‚
        â”‚    â€¢ category_encoded (0-6)       â”‚
        â”‚    â€¢ subcategory_encoded (0-9)    â”‚
        â”‚    â€¢ workload_encoded (0-6)       â”‚
        â”‚                                   â”‚
        â”‚ 2. Type Flags                     â”‚
        â”‚    â€¢ is_error_alert               â”‚
        â”‚    â€¢ is_resource_alert            â”‚
        â”‚    â€¢ is_network_alert             â”‚
        â”‚    â€¢ is_anomaly_alert             â”‚
        â”‚                                   â”‚
        â”‚ 3. Temporal (if datetime exists)  â”‚
        â”‚    â€¢ hour_of_day (0-23)           â”‚
        â”‚    â€¢ day_of_week (0-6)            â”‚
        â”‚    â€¢ is_business_hours (0/1)      â”‚
        â”‚    â€¢ is_weekend (0/1)             â”‚
        â”‚                                   â”‚
        â”‚ 4. Combinations                   â”‚
        â”‚    â€¢ is_critical_resource         â”‚
        â”‚    â€¢ is_saturation_memory         â”‚
        â”‚    â€¢ is_saturation_cpu            â”‚
        â”‚    â€¢ is_error_node                â”‚
        â”‚    â€¢ is_anomaly_latency           â”‚
        â”‚    â€¢ is_slo_violation             â”‚
        â”‚                                   â”‚
        â”‚ 5. Mapping Quality                â”‚
        â”‚    â€¢ mapping_confidence           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Combine into feature_dict         â”‚
        â”‚ (39 features total)               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Convert to DataFrame              â”‚
        â”‚ features_df = pd.DataFrame(list)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Handle Missing Values             â”‚
        â”‚ features_df.fillna(0)             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Standardize & Scale               â”‚
        â”‚ scaler.fit_transform()            â”‚
        â”‚                                   â”‚
        â”‚ Result: Each feature              â”‚
        â”‚ â€¢ Mean = 0                        â”‚
        â”‚ â€¢ Std Dev = 1                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
              feature_matrix_scaled
              [n_alerts Ã— 39]
                    â”‚
                    â–¼
                   END
```

---

## ğŸ² Clustering Algorithm Selection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MULTI-ALGORITHM CLUSTERING WITH AUTO-SELECTION            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: feature_matrix_scaled (n Ã— 39)
Output: cluster_id for each alert

                        START
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Check Sample Size           â”‚
            â”‚ n >= MIN_CLUSTERING_SAMPLES?â”‚
            â”‚ (default: 10)               â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚NO            â”‚YES
                   â–¼              â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
       â”‚ Skip Clusteringâ”‚        â”‚
       â”‚ Use initial    â”‚        â”‚
       â”‚ group IDs      â”‚        â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                                 â”‚
                                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ RUN 3 CLUSTERING ALGORITHMS        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
        â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ K-MEANS       â”‚ â”‚ DBSCAN        â”‚ â”‚ HIERARCHICAL â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               â”‚ â”‚               â”‚ â”‚              â”‚
â”‚ 1. Find k:    â”‚ â”‚ 1. Estimate   â”‚ â”‚ 1. Calculate â”‚
â”‚    For k=2..20â”‚ â”‚    eps:       â”‚ â”‚    n_clustersâ”‚
â”‚      Run      â”‚ â”‚    â€¢ k-NN     â”‚ â”‚    = n/20    â”‚
â”‚      KMeans   â”‚ â”‚    â€¢ 75th %ileâ”‚ â”‚              â”‚
â”‚      Compute  â”‚ â”‚    â€¢ Bound    â”‚ â”‚ 2. Run Agg   â”‚
â”‚      silh     â”‚ â”‚      [0.3,2.0]â”‚ â”‚    Clusteringâ”‚
â”‚    Best k =   â”‚ â”‚               â”‚ â”‚    â€¢ ward     â”‚
â”‚    argmax     â”‚ â”‚ 2. Run DBSCAN â”‚ â”‚    â€¢ n_clust â”‚
â”‚                â”‚ â”‚    â€¢ eps      â”‚ â”‚              â”‚
â”‚ 2. Final run: â”‚ â”‚    â€¢ min_samp â”‚ â”‚ 3. Get labelsâ”‚
â”‚    KMeans(k)  â”‚ â”‚      = n/100  â”‚ â”‚              â”‚
â”‚                â”‚ â”‚               â”‚ â”‚              â”‚
â”‚ 3. Get labels â”‚ â”‚ 3. Get labels â”‚ â”‚              â”‚
â”‚    & centroidsâ”‚ â”‚    (may have  â”‚ â”‚              â”‚
â”‚               â”‚ â”‚    noise: -1) â”‚ â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ EVALUATE EACH ALGORITHM            â”‚
        â”‚                                    â”‚
        â”‚ For each algorithm:                â”‚
        â”‚   1. Check validity:               â”‚
        â”‚      â€¢ num_clusters > 1?           â”‚
        â”‚      â€¢ noise_ratio < 30%?          â”‚
        â”‚                                    â”‚
        â”‚   2. IF valid:                     â”‚
        â”‚      Compute silhouette_score()    â”‚
        â”‚                                    â”‚
        â”‚   3. Track best_score & best_algo  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ SELECT WINNER                      â”‚
        â”‚                                    â”‚
        â”‚ algorithm = argmax(silhouette)     â”‚
        â”‚                                    â”‚
        â”‚ Typical winners:                   â”‚
        â”‚ â€¢ K-Means: 60% of time             â”‚
        â”‚ â€¢ DBSCAN: 25% of time              â”‚
        â”‚ â€¢ Hierarchical: 15% of time        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ASSIGN FINAL LABELS                â”‚
        â”‚                                    â”‚
        â”‚ final_labels = selected.labels     â”‚
        â”‚                                    â”‚
        â”‚ For each alert:                    â”‚
        â”‚   alert['cluster_id'] = label[i]   â”‚
        â”‚   alert['clustering_method'] = algoâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
                    END

Quality Metrics:
  Silhouette Score: 0.3-0.6 (typical)
  Final Clusters: 10-50 (for 1K alerts)
  Processing Time: ~5-10 seconds
```

---

## ğŸ¯ K-Means Optimal k Selection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      OPTIMAL K SELECTION VIA SILHOUETTE              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: feature_matrix_scaled
Output: optimal k value

              START
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Calculate max_k       â”‚
    â”‚ = min(20, n/5)        â”‚
    â”‚                       â”‚
    â”‚ Ensure: max_k >= 2    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Initialize            â”‚
    â”‚ â€¢ silhouette_scores=[]â”‚
    â”‚ â€¢ K_range = 2..max_k  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FOR k IN K_range:                 â”‚
    â”‚   â”‚                               â”‚
    â”‚   â”œâ”€â†’ Run KMeans(n_clusters=k)    â”‚
    â”‚   â”‚     â””â”€ n_init=10, random=42   â”‚
    â”‚   â”‚                               â”‚
    â”‚   â”œâ”€â†’ Get cluster labels          â”‚
    â”‚   â”‚                               â”‚
    â”‚   â”œâ”€â†’ Compute silhouette_score()  â”‚
    â”‚   â”‚     (measures cluster quality)â”‚
    â”‚   â”‚                               â”‚
    â”‚   â””â”€â†’ Append to scores list       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Find Best k           â”‚
    â”‚                       â”‚
    â”‚ best_k = K_range[     â”‚
    â”‚   argmax(scores)      â”‚
    â”‚ ]                     â”‚
    â”‚                       â”‚
    â”‚ Example:              â”‚
    â”‚ k=2: score=0.32       â”‚
    â”‚ k=5: score=0.45       â”‚
    â”‚ k=10: score=0.51 â† âœ“  â”‚
    â”‚ k=15: score=0.43      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
         return best_k
            â”‚
            â–¼
           END

Silhouette Score Interpretation:
  0.7-1.0: Excellent separation
  0.5-0.7: Good clusters
  0.3-0.5: Acceptable
  0.0-0.3: Weak structure
  < 0.0:   Poor clustering
```

---

## ğŸŒ³ Graph-Based Consolidation Tree

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SERVICE RELATIONSHIP CONSOLIDATION LOGIC                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: enriched_alerts (with graph_service)
Output: consolidated_groups

              START
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Step 1: Group by Service          â”‚
    â”‚                                   â”‚
    â”‚ For each alert:                   â”‚
    â”‚   IF graph_service exists:        â”‚
    â”‚      service_groups[svc].add()    â”‚
    â”‚   ELSE:                           â”‚
    â”‚      unmapped_alerts.add()        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Step 2: Find Related Services             â”‚
    â”‚                                           â”‚
    â”‚ For each service (primary):               â”‚
    â”‚                                           â”‚
    â”‚   related = {}                            â”‚
    â”‚                                           â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚   â”‚ Check Neighbors (forward)   â”‚        â”‚
    â”‚   â”‚   For s in graph.neighbors: â”‚        â”‚
    â”‚   â”‚     IF s in service_groups: â”‚        â”‚
    â”‚   â”‚        related.add(s)        â”‚        â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
    â”‚                                           â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚   â”‚ Check Predecessors (reverse)â”‚        â”‚
    â”‚   â”‚   For s in predecessors:    â”‚        â”‚
    â”‚   â”‚     IF s in service_groups: â”‚        â”‚
    â”‚   â”‚        related.add(s)        â”‚        â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
    â”‚                                           â”‚
    â”‚   Result: related[Set]                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Step 3: Create Consolidated Group         â”‚
    â”‚                                           â”‚
    â”‚ group = {                                 â”‚
    â”‚   primary_service: current_service        â”‚
    â”‚   related_services: related[Set]          â”‚
    â”‚   alerts: []                              â”‚
    â”‚ }                                         â”‚
    â”‚                                           â”‚
    â”‚ Add alerts from primary service           â”‚
    â”‚ Add alerts from each related service      â”‚
    â”‚ Mark related services as processed        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Step 4: Handle Unmapped Alerts            â”‚
    â”‚                                           â”‚
    â”‚ For each unmapped alert:                  â”‚
    â”‚                                           â”‚
    â”‚   Priority Grouping:                      â”‚
    â”‚                                           â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚   â”‚ cluster + namespace? YES     â”‚       â”‚
    â”‚   â”‚   key = "cluster_ns:..."     â”‚       â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â”‚          â”‚NO                              â”‚
    â”‚          â–¼                                â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚   â”‚ namespace + node? YES        â”‚       â”‚
    â”‚   â”‚   key = "ns_node:..."        â”‚       â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â”‚          â”‚NO                              â”‚
    â”‚          â–¼                                â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚   â”‚ cluster only? YES            â”‚       â”‚
    â”‚   â”‚   key = "cluster:..."        â”‚       â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â”‚          â”‚NO                              â”‚
    â”‚          â–¼                                â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚   â”‚ namespace only? YES          â”‚       â”‚
    â”‚   â”‚   key = "namespace:..."      â”‚       â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â”‚          â”‚NO                              â”‚
    â”‚          â–¼                                â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚   â”‚ node only? YES               â”‚       â”‚
    â”‚   â”‚   key = "node:..."           â”‚       â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â”‚          â”‚NO                              â”‚
    â”‚          â–¼                                â”‚
    â”‚   key = "unknown:unknown"                â”‚
    â”‚                                           â”‚
    â”‚   Group by key                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Step 5: Add Group Metadata                â”‚
    â”‚                                           â”‚
    â”‚ For each group:                           â”‚
    â”‚   â€¢ severity_distribution                 â”‚
    â”‚   â€¢ category_distribution                 â”‚
    â”‚   â€¢ subcategory_distribution              â”‚
    â”‚   â€¢ time_span_minutes                     â”‚
    â”‚   â€¢ most_common_alert/category/subcategoryâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
      consolidated_groups
            â”‚
            â–¼
           END

Example Grouping:
  Service A alerts (20) + Service B alerts (15)
  â†’ IF A and B are neighbors in graph
  â†’ Merged into 1 group (35 alerts)
```

---

## ğŸ” Deduplication Flow (Within Cluster)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         WITHIN-CLUSTER DEDUPLICATION ALGORITHM                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: Alerts in one cluster
Output: Deduplicated alerts with is_duplicate flags

              START
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Get all alerts in cluster         â”‚
    â”‚ cluster_alerts = alerts[          â”‚
    â”‚   cluster_id == current           â”‚
    â”‚ ]                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ IF cluster_id == -1 (noise):      â”‚
    â”‚   Add all without deduplication   â”‚
    â”‚   â†’ DONE                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚NO (normal cluster)
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Initialize:                       â”‚
    â”‚ â€¢ processed_indices = {}          â”‚
    â”‚ â€¢ duplicates_found = []           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FOR i IN cluster_alerts:                â”‚
    â”‚   â”‚                                     â”‚
    â”‚   â”œâ”€ IF i in processed: SKIP           â”‚
    â”‚   â”‚                                     â”‚
    â”‚   â”œâ”€ alert_i.is_duplicate = False      â”‚
    â”‚   â”‚                                     â”‚
    â”‚   â”œâ”€ duplicates_of_i = []              â”‚
    â”‚   â”‚                                     â”‚
    â”‚   â””â”€â†’ FOR j IN cluster_alerts (j > i): â”‚
    â”‚        â”‚                                â”‚
    â”‚        â”œâ”€ IF j in processed: SKIP      â”‚
    â”‚        â”‚                                â”‚
    â”‚        â”œâ”€â†’ score = compare(i, j)       â”‚
    â”‚        â”‚    â”‚                           â”‚
    â”‚        â”‚    â”œâ”€ Temporal check           â”‚
    â”‚        â”‚    â”‚   IF |time_i - time_j|>5mâ”‚
    â”‚        â”‚    â”‚      score = 0, SKIP     â”‚
    â”‚        â”‚    â”‚                           â”‚
    â”‚        â”‚    â”œâ”€ Accumulate points:      â”‚
    â”‚        â”‚    â”‚   â€¢ alert_name: +3       â”‚
    â”‚        â”‚    â”‚   â€¢ service: +3          â”‚
    â”‚        â”‚    â”‚   â€¢ severity: +1         â”‚
    â”‚        â”‚    â”‚   â€¢ cat+subcat: +2       â”‚
    â”‚        â”‚    â”‚   â€¢ description: +2      â”‚
    â”‚        â”‚    â”‚   â€¢ init_group: +1       â”‚
    â”‚        â”‚    â”‚   â€¢ pod: +4              â”‚
    â”‚        â”‚    â”‚   â€¢ ns+cluster: +1       â”‚
    â”‚        â”‚    â”‚                           â”‚
    â”‚        â”‚    â””â”€ Return total score      â”‚
    â”‚        â”‚                                â”‚
    â”‚        â”œâ”€â†’ IF score >= 5:               â”‚
    â”‚        â”‚    â”œâ”€ duplicates_of_i.add(j)  â”‚
    â”‚        â”‚    â”œâ”€ alert_j.is_duplicate=Trueâ”‚
    â”‚        â”‚    â”œâ”€ alert_j.duplicate_of = iâ”‚
    â”‚        â”‚    â””â”€ processed.add(j)        â”‚
    â”‚        â”‚                                â”‚
    â”‚        â””â”€â†’ ELSE: Not duplicate         â”‚
    â”‚                                         â”‚
    â”‚   â”œâ”€â†’ Add alert_i to deduplicated_list â”‚
    â”‚   â”‚                                     â”‚
    â”‚   â”œâ”€â†’ IF duplicates_of_i not empty:    â”‚
    â”‚   â”‚     Store duplicate_group           â”‚
    â”‚   â”‚                                     â”‚
    â”‚   â””â”€â†’ processed.add(i)                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
              deduplicated_alerts
                          â”‚
                          â–¼
                         END

Example:
  Cluster 5 has 100 alerts
  â†’ Compare 100Ã—99/2 = 4,950 pairs
  â†’ Find 35 duplicates
  â†’ Output: 65 unique alerts
```

---

## ğŸ“Š Export Decision Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  EXPORT GENERATION FLOW                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

              START
                â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚          â”‚                          â”‚
     â–¼          â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Main     â”‚ â”‚ Cluster  â”‚            â”‚ Dedup    â”‚
â”‚ Results  â”‚ â”‚ Summary  â”‚            â”‚ Alerts   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚                       â”‚
     â–¼            â–¼                       â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Main Results Export                                â”‚
â”‚                                                    â”‚
â”‚ For each alert in enriched_alerts:                â”‚
â”‚   Collect:                                         â”‚
â”‚   â€¢ alert_id (index)                               â”‚
â”‚   â€¢ final_group_id (cluster_id)                    â”‚
â”‚   â€¢ initial_group_id (from Phase 4)                â”‚
â”‚   â€¢ clustering_method                              â”‚
â”‚   â€¢ is_duplicate                                   â”‚
â”‚   â€¢ duplicate_of                                   â”‚
â”‚   â€¢ alert_name, severity, service_name             â”‚
â”‚   â€¢ namespace, cluster, pod, node                  â”‚
â”‚   â€¢ graph_service, mapping_method, confidence      â”‚
â”‚   â€¢ starts_at, start_timestamp                     â”‚
â”‚   â€¢ alert_category, alert_subcategory              â”‚
â”‚   â€¢ workload_type, anomaly_resource_type           â”‚
â”‚   â€¢ description                                    â”‚
â”‚                                                    â”‚
â”‚ â†’ alert_consolidation_final.csv                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cluster Summary Export                             â”‚
â”‚                                                    â”‚
â”‚ Group alerts by cluster_id:                       â”‚
â”‚   For each cluster:                                â”‚
â”‚     Calculate:                                     â”‚
â”‚     â€¢ alert_count                                  â”‚
â”‚     â€¢ unique_alert_types                           â”‚
â”‚     â€¢ most_common_alert                            â”‚
â”‚     â€¢ unique_services                              â”‚
â”‚     â€¢ primary_service                              â”‚
â”‚     â€¢ namespaces (top 5)                           â”‚
â”‚     â€¢ severity_distribution                        â”‚
â”‚     â€¢ category_distribution                        â”‚
â”‚     â€¢ subcategory_distribution                     â”‚
â”‚     â€¢ most_common_category/subcategory             â”‚
â”‚     â€¢ clustering_method                            â”‚
â”‚                                                    â”‚
â”‚ Sort by alert_count (descending)                  â”‚
â”‚                                                    â”‚
â”‚ â†’ cluster_summary.csv                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Deduplicated Alerts Export                         â”‚
â”‚                                                    â”‚
â”‚ Filter: alerts where is_duplicate == False        â”‚
â”‚                                                    â”‚
â”‚ For each unique alert:                            â”‚
â”‚   Collect:                                         â”‚
â”‚   â€¢ alert_name, service_name, graph_service        â”‚
â”‚   â€¢ cluster_id, namespace, cluster                 â”‚
â”‚   â€¢ severity, category, subcategory                â”‚
â”‚   â€¢ starts_at                                      â”‚
â”‚                                                    â”‚
â”‚ â†’ deduplicated_alerts.csv                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Additional Exports:
  â”œâ”€â†’ mapping_statistics.csv (counts by method)
  â”œâ”€â†’ clustering_statistics.csv (algorithm comparison)
  â””â”€â†’ From example script:
        â”œâ”€ high_priority_alerts.csv
        â”œâ”€ root_cause_candidates.csv
        â””â”€ alerts_namespace_*.csv
```

---

## ğŸ¯ Real-Time Alert Assignment Flow (Future Use)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ASSIGN NEW INCOMING ALERT TO EXISTING CLUSTERS              â”‚
â”‚                (After Initial Consolidation Run)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: new_alert (incoming)
Output: assigned cluster_id

                  START (New Alert Arrives)
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Extract Alert Metadata      â”‚
            â”‚ â€¢ service_name              â”‚
            â”‚ â€¢ category, subcategory     â”‚
            â”‚ â€¢ severity, namespace, etc. â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Map to Graph Service        â”‚
            â”‚ (same logic as Phase 3)     â”‚
            â”‚                             â”‚
            â”‚ â€¢ Direct match OR           â”‚
            â”‚ â€¢ Fallback scoring          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Extract 39 Features         â”‚
            â”‚ (same as Phase 5)           â”‚
            â”‚                             â”‚
            â”‚ â€¢ Graph topology (if mapped)â”‚
            â”‚ â€¢ Alert metadata            â”‚
            â”‚ â€¢ Temporal features         â”‚
            â”‚ â€¢ Combinations              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Scale Features              â”‚
            â”‚ new_features_scaled =       â”‚
            â”‚   scaler.transform([feats]) â”‚
            â”‚ (Use pre-fitted scaler)     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Find Nearest Cluster        â”‚
            â”‚                             â”‚
            â”‚ IF clustering_method =      â”‚
            â”‚    'kmeans':                â”‚
            â”‚   â€¢ Get centroids           â”‚
            â”‚   â€¢ Calculate distances     â”‚
            â”‚   â€¢ cluster = argmin(dist)  â”‚
            â”‚                             â”‚
            â”‚ ELIF 'hierarchical':        â”‚
            â”‚   â€¢ Use linkage tree        â”‚
            â”‚                             â”‚
            â”‚ ELSE:                       â”‚
            â”‚   â€¢ Similarity search       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Assign cluster_id           â”‚
            â”‚                             â”‚
            â”‚ Optional: Calculate         â”‚
            â”‚ confidence score            â”‚
            â”‚ (distance to centroid)      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                  assigned cluster_id
                          â”‚
                          â–¼
                         END

Usage:
  â€¢ Real-time alert stream
  â€¢ Assign to existing groups
  â€¢ No need to re-cluster
  â€¢ Fast: O(k) for k clusters
```

---

## ğŸ¨ Feature Weighting Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FEATURE IMPORTANCE HIERARCHY                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Feature Categories by Impact on Clustering:

HIGH IMPACT (Drive cluster separation)
â”œâ”€ alert_category_encoded â­â­â­â­â­
â”œâ”€ alert_subcategory_encoded â­â­â­â­â­
â”œâ”€ is_saturation_cpu â­â­â­â­
â”œâ”€ is_saturation_memory â­â­â­â­
â”œâ”€ is_critical_resource â­â­â­â­
â”œâ”€ severity_encoded â­â­â­â­
â””â”€ workload_type_encoded â­â­â­

MEDIUM IMPACT (Refine clusters)
â”œâ”€ pagerank â­â­â­
â”œâ”€ betweenness â­â­â­
â”œâ”€ dependency_direction â­â­â­
â”œâ”€ is_error_alert â­â­
â”œâ”€ is_resource_alert â­â­
â”œâ”€ is_business_hours â­â­
â””â”€ mapping_confidence â­â­

LOW IMPACT (Context features)
â”œâ”€ hour_of_day â­
â”œâ”€ day_of_week â­
â”œâ”€ avg_neighbor_degree â­
â””â”€ max_neighbor_degree â­

Why This Matters:
  â€¢ Category/subcategory = Alert TYPE
  â€¢ Combinations = Specific PATTERNS
  â€¢ Graph features = Service CONTEXT
  â€¢ Temporal = Time PATTERNS

Together â†’ Comprehensive alert understanding
```

---

*For complete solution architecture, see [SOLUTION_ARCHITECTURE.md](SOLUTION_ARCHITECTURE.md)*

